import{$,hide,show}from'../utils/dom.js';import{AuthService}from'../services/auth.js';import{Modal}from'../components/Modal.js';import{validators}from'../utils/validators.js';const loginModal=new Modal('login-modal-overlay');const registerModal=new Modal('register-modal-overlay');const guestModal=new Modal('guest-modal-overlay');$('#show-login-btn')?.addEventListener('click',()=>loginModal.open());$('#show-register-btn')?.addEventListener('click',()=>registerModal.open());$('#hero-guest-btn')?.addEventListener('click',()=>guestModal.open());$('#login-form')?.addEventListener('submit',async(e)=>{e.preventDefault();const username=$('#login-username').value;const password=$('#login-password').value;try{await AuthService.login(username,password);window.location.href='/dashboard.html'}catch(err){$('#login-error').textContent=err.message;show($('#login-error'))}});$('#register-form')?.addEventListener('submit',async(e)=>{e.preventDefault();const username=$('#register-username').value;const password=$('#register-password').value;const confirm=$('#register-password-confirm').value;if(password!==confirm){$('#register-error').textContent='Hasła nie są identyczne';show($('#register-error'));return}if(!validators.username(username)){$('#register-error').textContent='Nieprawidłowa nazwa użytkownika';show($('#register-error'));return}try{await AuthService.register(username,password);window.location.href='/dashboard.html'}catch(err){$('#register-error').textContent=err.message;show($('#register-error'))}});$('#guest-form')?.addEventListener('submit',async(e)=>{e.preventDefault();const name=$('#guest-name').value||null;try{await AuthService.guest(name);window.location.href='/dashboard.html'}catch(err){$('#guest-error').textContent=err.message;show($('#guest-error'))}});$('#switch-to-register')?.addEventListener('click',()=>{loginModal.close();registerModal.open()});$('#switch-to-login')?.addEventListener('click',()=>{registerModal.close();loginModal.open()});
